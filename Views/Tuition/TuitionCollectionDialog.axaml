<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:ViewModels"
        x:Class="Views.Tuition.TuitionCollectionDialog"
        Title="Thu há»c phÃ­"
        Width="900"
        Height="650"
        ExtendClientAreaToDecorationsHint="True"
        ExtendClientAreaChromeHints="NoChrome"
        SystemDecorations="None"
        TransparencyLevelHint="AcrylicBlur"
        Background="Transparent"
        WindowStartupLocation="CenterOwner"
        CornerRadius="10"
        Padding="0"
        x:DataType="vm:TuitionViewModel">

    <Border CornerRadius="10" Background="White" BorderBrush="#E0E0E0" BorderThickness="1" BoxShadow="0 4 16 #1A000000">
        <Grid RowDefinitions="Auto,*,Auto">
            <!-- Header -->
               <Border Padding="20,16" CornerRadius="10,10,0,0">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                            <GradientStop Color="#FF4285F4" Offset="0" />
                            <GradientStop Color="#FF1E88E5" Offset="1" />
                        </LinearGradientBrush>
                    </Border.Background>
                <Grid ColumnDefinitions="*,Auto,Auto">
                       <StackPanel Grid.Column="0" Spacing="4">
                           <TextBlock Text="Chi tiáº¿t há»c phÃ­"
                                      FontSize="20"
                                      FontWeight="Bold"
                                      Foreground="White"/>
                           <TextBlock Text="Xem chi tiáº¿t khoáº£n phÃ­ theo thÃ¡ng"
                                      FontSize="12"
                                      Foreground="#E3F2FD"
                                      Opacity="0.9"/>
                       </StackPanel>
                       <Button Grid.Column="1"
                               Content="ðŸ“¥ Xuáº¥t Excel"
                               Background="White"
                               Foreground="#1E88E5"
                               FontWeight="Bold"
                               Padding="14,8"
                               BorderThickness="0"
                               CornerRadius="6"
                               Margin="0,0,12,0"
                               Click="ExportExcel_Click"
                               Cursor="Hand"/>
                    <Button Grid.Column="2"
                            Content="âœ•"
                            Background="Transparent"
                            Foreground="White"
                               FontSize="20"
                            BorderThickness="0"
                               Padding="10"
                               Click="Close_Click"
                               Cursor="Hand"/>
                </Grid>
            </Border>

            <!-- Ná»™i dung -->
               <ScrollViewer Grid.Row="1" Padding="24">
                   <StackPanel Spacing="20">
                    <!-- Filter panel -->
                       <Border Padding="16" Background="#F5F5F5" CornerRadius="8" BorderBrush="#E8E8E8" BorderThickness="1">
                           <StackPanel Spacing="12">
                               <StackPanel Orientation="Horizontal" Spacing="8">
                                   <Path Data="M 9 1 Q 16 1 16 8 L 16 14 M 1 16 L 14 3" 
                                         Stroke="#666" StrokeThickness="1.5" 
                                         Width="16" Height="16" 
                                         VerticalAlignment="Center"/>
                                   <TextBlock Text="Bá»™ lá»c" FontWeight="SemiBold" FontSize="13" Foreground="#333" />
                               </StackPanel>
                               <StackPanel Orientation="Horizontal" Spacing="16">
                                   <StackPanel Spacing="6">
                                       <TextBlock Text="Há»c ká»³" FontSize="12" FontWeight="Medium" Foreground="#555"/>
                                    <ComboBox ItemsSource="{Binding TermDisplayList}" 
                                              SelectedItem="{Binding SelectedTermDisplay}"
                                                 Width="200"
                                                 Padding="8,6"/>
                                </StackPanel>

                                   <StackPanel Spacing="6">
                                       <TextBlock Text="ThÃ¡ng" FontSize="12" FontWeight="Medium" Foreground="#555"/>
                                    <ComboBox ItemsSource="{Binding MonthList}" 
                                              SelectedItem="{Binding SelectedMonth}"
                                                 Width="180"
                                                 Padding="8,6"
                                              SelectionChanged="MonthComboBox_SelectionChanged"/>
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Summary: danh sÃ¡ch há»c sinh (Quáº£n lÃ½ há»c phÃ­) -->
                    <!-- REMOVED: Danh sÃ¡ch há»c sinh khÃ´ng cáº§n hiá»ƒn thá»‹ -->

                    <!-- DataGrid chi tiáº¿t há»c phÃ­ -->
                       <StackPanel Spacing="12">
                           <TextBlock Text="Chi tiáº¿t khoáº£n phÃ­"
                                      FontSize="16"
                                      FontWeight="Bold"
                                      Foreground="#333"/>
                        <DataGrid x:Name="TuitionDetailGrid"
                                  AutoGenerateColumns="False"
                                  CanUserResizeColumns="True"
                                     Height="380"
                                  ItemsSource="{Binding StudentFeeMonthDetail}"  
                                     GridLinesVisibility="Horizontal"
                                     BorderThickness="1"
                                     BorderBrush="#E0E0E0">
                            <DataGrid.Columns>
                                   <DataGridTextColumn Width="*" Header="Diá»…n giáº£i" Binding="{Binding FeeTemplateName}" />
                                <DataGridTextColumn Width="150" Header="Sá»‘ tiá»n" Binding="{Binding Amount, StringFormat='{}{0:N0} Ä‘'}" />
                                   <DataGridTextColumn Width="140" Header="Tá»« ngÃ y" Binding="{Binding StartDate}" />
                                   <DataGridTextColumn Width="140" Header="Äáº¿n ngÃ y" Binding="{Binding EndDate}" />
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </StackPanel>
            </ScrollViewer>

            <!-- Footer -->
               <Border Grid.Row="2" Padding="20" BorderThickness="0,1,0,0" BorderBrush="#E0E0E0" Background="#FAFAFA">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Spacing="10">
                       <Button Content="ÄÃ³ng" Click="Close_Click" Padding="18,10" Background="#1E88E5" Foreground="White" FontWeight="Bold" BorderThickness="0" CornerRadius="6" Cursor="Hand" />
                </StackPanel>
            </Border>
        </Grid>
    </Border>
</Window>
